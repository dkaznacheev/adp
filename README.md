# ADP - Async Data Processing system
ADP - система для распределённой обработки данных, реализованная на корутинах Kotlin.

# Сборка и запуск
Для сборки под Linux необходимо запустить `./gradlew :jar`. Собранный jar можно найти в `build/libs/adp.jar`.

## Запуск в режиме рабочего узла
В режиме рабочего узла jar-файл запускается из отдельной директории, содержащей файл `workers.properties`. 
В этом файле могут быть указаны адрес мастер-узла и размер блока, помещаемого в память по умолчанию во время шаффла.
Пример таких директорий можно найти в папках `workers/worker1` и `workers/worker2`

Запуск в режиме рабочего узла осуществляется со следующими аргументами:

`java -jar adp.jar worker <port>`. 

Рабочий узел после запуска ожидает задачи и выключается по сигналу прерывания (Ctrl+C)

## Запуск в режиме мастер-узла
В режиме тестирования мастер-узла jar-файл запускается из директории, содержащей файл `workers.conf`. Этот файл содержит адреса доступных
рабочих узлов, отделённые переводом строки. Пример такого файла можно найти в `workers.conf` в корне проекта.
Для тестирования распределённого режима необходимо запустить jar-файл со следующими параметрами:

`java -jar adp.jar master <number of workers> <dataset size> <task>`
* `number of workers` - количество рабочих узлов (если указано W, меньшее, чем узлов в файле `workers.conf`, из файла берутся первые W адресов)
* `dataset size` - размер N генерируемого датасета для тестов.
* `task` - имя задания:
  * `count` - Сценарий свёртки по ключу, использующий shuffle между узлами.
  В сценарии генерируются N случайных чисел от 0 до 99, для каждого из которых считается частота,
  после чего выводится самое часто встречающееся число и количество его вхождений.
  * `http` - сценарий параллельных запросов. В сценарии генерируются N случайных чисел от 0 до 9, которые передаются 
  параметром в get-запрос на эхо-сервис https://postman-echo.com. Из результатов обратно извлекаются числа, которые затем складываются в ожин результат.
